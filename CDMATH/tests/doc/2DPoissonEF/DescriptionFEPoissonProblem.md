
### Weak formulation
Using the **Green-Ostrograski** formula, the above problem is transformed into the following **weak formulation** by:

Find $u \in \mathbf{H}^{1}_{0}$ such that:

 \begin{equation}
 \forall v \in \mathbf{H}^{1}_{0},\;\;\;\; \int_{\Omega}
 \vec{\nabla}u.
 \vec{\nabla}v dx = \int_{\Omega}fvdx.\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\; (1)
\end{equation}

### Existence of the weak solution
The bilinear form $a(u,v) = \int_{\Omega}
 \vec{\nabla}u.
 \vec{\nabla}v dx$, $a(.,.)$ is continuous and coercive thanks to **PoincarÃ© inequality**. The linear form $b(v) = \int_{\Omega}fvdx$, $b(.)$ is continuous. Thanks to these properties, the **Lax-Milgram theorem** ensures the existence and uniqueness of the **weak solution**  of the variational formulation (1).
  
###  Regularity of the solution
The weak solution $u \in \mathbf{H}^{1}_{0}$ of the variational problem (1) actually belongs to $\mathbf{H}^{2}_{0}$ that is it is twice weakly differentiable with $-\Delta u=f$ in the weak sense.

More generally, for $m \geq 0,$ if $\Omega \in (\mathbb{R}^{N})$ is an open bounded set with piecewise $\mathcal{C}^{m + 2}$ boundary and $f \in \mathbf{H}^{m}(\Omega).$ Then the unique solution $u_{f} \in \mathbf{H}^{1}_{0}(\Omega)$ of the weak formulation (1) belongs to $\mathbf{H}^{m + 2}(\Omega).$
 Furthermore, $u_{f}$ depends continuously of $f \in \mathbf{H}^{m}(\Omega)$:
$$\exists C > 0, \;\; \forall f \in \mathbf{L}^{2}, \;\;\; ||u_{f}||_{\mathbf{H}^{m + 2}_{0}(\Omega)} \leq C ||f||_{\mathbf{H}^{m}(\Omega)}. $$ 

### The finite element method
Let $\mathbf{V}_{h}\subset \mathbf{H}^{1}_{0}(\Omega),$  $u_{h}$ the projection of the exact solution $u$ on $\mathbf{V}_{h}$ and $v_{h}$ the projection of the test function $v$ on $\mathbf{V}_{h}$. Then the above variational formulation becomes 

\begin{equation}
\text{ find }\; u_h \in V_h\; \text{ such that}\;\;
a(u_h , v_h) = b(v_h), \;\;\;\forall v_h \in V_h,
\end{equation}
where $a_h( u_h,v_h)$ is a symmetric positive-definite bilinear form.
 
Taking $V_h$ generated by the nodal basis functions $(\phi_j)_{1\leq j \leq N_h},$ we have $u_h = \sum_{j=1}^{N_h}u_j\phi_j,$ and the above problem becomes 

\begin{equation*}
\text{ find }\; u_h \in \mathbb{R}^{N_h}\; \text{ such that}\;\;
a(\sum_{j=1}^{N_h}u_j\phi_j , \phi_i) = b(\phi_i), \;\;\;\forall 1 \leq i \leq N_h.
\end{equation*}
Which can be written in the form of a linear system
\begin{equation}
\mathcal{A}_{h}U_h = b_h,
\end{equation}
with matrix $(\mathcal{A}_h)_{ij}   = (a_{ij})$, right hand side $(b_{h})_{i} = (b_{j})$, and unknown $U_h = (u_1, ...,u_{N_h})$.


\begin{equation}
a_{ij} = a(\phi_{i},\phi_{j}) = \int_{\Omega} \vec{\nabla}\phi_{i}.\vec{\nabla}\phi_{j}dx. 
\end{equation}
\begin{equation}
b_{j} = b(\phi_{i}) = \int_{\Omega} f\phi_{i}dx.
\end{equation}

$\mathcal{A}_{h}$ is a symmetric, positive definite M-matrix, hence the existence of a discrete solution. 



The domain $\Omega$ is decomposed into thetrahedral cells $\mathcal{T}_{k}$.
* $\left|\mathcal{T}_{k}\right|$ is the measure of the cell $\mathcal{T}_{k}$.

* $\phi_{j}(\vec{x}_{s_{i}^{k}}) = \delta_{ij}$ is the test function on the cell $\mathcal{T}_{k}$ at the node $\vec{x}_{s_{i}^{k}}$, where  $s^{k}_{1},$ $s_{2}^{k}$, and $s^{k}_{3}$ are the vertices of the cell $\mathcal{T}_{k}$.
 
    $\mathcal{A}_h$ is an $n\times n$ symetric positive definite sparse matrix with entries given by: $$a_{ij} = \sum_{k}\int_{\mathcal{T}_{k}}\vec{\nabla}\phi_{i}.\vec{\nabla}\phi_{j} = \sum_{k}a_{i}^{k},$$ 
    and $(b_h)$ is an $n$ dimensional vector which entries are given by $$b_{i} = \sum_{k}\int_{\mathcal{T}_{k}}f\phi_{i} = \sum_{k}b_{i}^{k},$$ 
    and  
 $$b_{i}^{k} = \int_{T_k}f\phi_{i}dx \approx \frac{|T_k|}{3}\left(f(\vec{x}_{s^{k}_1})\phi_{i}(\vec{x}_{s^{k}_1}) +  f(\vec{x}_{s^{k}_2})\phi_{i}(\vec{x}_{s^{k}_2}) + f(\vec{x}_{s^{k}_3})\phi_{i}(\vec{x}_{s^{k}_3}) )\phi_{i}
 (\vec{x}_{s^{k}_4})\right).$$
 
